==============================================
CSDI Trajectory Generator
==============================================
Job ID: 5180880
Node: gpu004
Started: Thu Jan  1 16:32:51 EST 2026

Python: /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/miniconda3-22.11.1-gy/bin/python
PyTorch: 2.9.1+cu128
CUDA available: True

Starting training...
Config: 6 layers, d_ff=1024, cosine schedule
Physics losses: accel_penalty=0.05, jerk_penalty=0.02, accel_dist=0.1
============================================================
CSDI Trajectory Generator - Training
============================================================
Device: cuda
Epochs: 200
Diffusion steps: 200
Loading 6367 trajectory files...
Vehicle type augmentation ENABLED (generating truck, bus, sports car variants)
Loaded 17973 valid trajectories (including augmented)
Model parameters: 5,496,321
Epoch 1: Loss = 0.3383, LR = 1.00e-04
Epoch 2: Loss = 0.3131, LR = 1.00e-04
Epoch 3: Loss = 0.2991, LR = 9.99e-05
Epoch 4: Loss = 0.2564, LR = 9.99e-05
Epoch 5: Loss = 0.2426, LR = 9.98e-05
Epoch 6: Loss = 0.2380, LR = 9.98e-05
Epoch 7: Loss = 0.2342, LR = 9.97e-05
Epoch 8: Loss = 0.2294, LR = 9.96e-05
Epoch 9: Loss = 0.2298, LR = 9.95e-05
Epoch 10: Loss = 0.2265, LR = 9.94e-05
Epoch 11: Loss = 0.2265, LR = 9.93e-05
Epoch 12: Loss = 0.2244, LR = 9.91e-05
Epoch 13: Loss = 0.2227, LR = 9.90e-05
Epoch 14: Loss = 0.2217, LR = 9.88e-05
Epoch 15: Loss = 0.2218, LR = 9.86e-05
Epoch 16: Loss = 0.2220, LR = 9.84e-05
Epoch 17: Loss = 0.2209, LR = 9.82e-05
Epoch 18: Loss = 0.2212, LR = 9.80e-05
Epoch 19: Loss = 0.2192, LR = 9.78e-05
Epoch 20: Loss = 0.2195, LR = 9.76e-05
Epoch 21: Loss = 0.2190, LR = 9.73e-05
Epoch 22: Loss = 0.2194, LR = 9.70e-05
Epoch 23: Loss = 0.2188, LR = 9.68e-05
Epoch 24: Loss = 0.2164, LR = 9.65e-05
Epoch 25: Loss = 0.2169, LR = 9.62e-05
Epoch 26: Loss = 0.2165, LR = 9.59e-05
Epoch 27: Loss = 0.2159, LR = 9.56e-05
Epoch 28: Loss = 0.2164, LR = 9.52e-05
Epoch 29: Loss = 0.2161, LR = 9.49e-05
Epoch 30: Loss = 0.2153, LR = 9.46e-05
Epoch 31: Loss = 0.2158, LR = 9.42e-05
Epoch 32: Loss = 0.2154, LR = 9.38e-05
Epoch 33: Loss = 0.2145, LR = 9.34e-05
Epoch 34: Loss = 0.2141, LR = 9.30e-05
Epoch 35: Loss = 0.2141, LR = 9.26e-05
Epoch 36: Loss = 0.2148, LR = 9.22e-05
Epoch 37: Loss = 0.2128, LR = 9.18e-05
Epoch 38: Loss = 0.2124, LR = 9.14e-05
Epoch 39: Loss = 0.2133, LR = 9.09e-05
Epoch 40: Loss = 0.2127, LR = 9.05e-05
Epoch 41: Loss = 0.2122, LR = 9.00e-05
Epoch 42: Loss = 0.2131, LR = 8.95e-05
Epoch 43: Loss = 0.2132, LR = 8.90e-05
Epoch 44: Loss = 0.2122, LR = 8.85e-05
Epoch 45: Loss = 0.2118, LR = 8.80e-05
Epoch 46: Loss = 0.2116, LR = 8.75e-05
Epoch 47: Loss = 0.2131, LR = 8.70e-05
Epoch 48: Loss = 0.2118, LR = 8.64e-05
Epoch 49: Loss = 0.2115, LR = 8.59e-05
Epoch 50: Loss = 0.2110, LR = 8.54e-05
Epoch 51: Loss = 0.2114, LR = 8.48e-05
Epoch 52: Loss = 0.2111, LR = 8.42e-05
Epoch 53: Loss = 0.2109, LR = 8.37e-05
Epoch 54: Loss = 0.2114, LR = 8.31e-05
Epoch 55: Loss = 0.2097, LR = 8.25e-05
Epoch 56: Loss = 0.2106, LR = 8.19e-05
Epoch 57: Loss = 0.2108, LR = 8.13e-05
Epoch 58: Loss = 0.2107, LR = 8.06e-05
Epoch 59: Loss = 0.2097, LR = 8.00e-05
Epoch 60: Loss = 0.2098, LR = 7.94e-05
Epoch 61: Loss = 0.2106, LR = 7.88e-05
Epoch 62: Loss = 0.2100, LR = 7.81e-05
Epoch 63: Loss = 0.2101, LR = 7.75e-05
Epoch 64: Loss = 0.2100, LR = 7.68e-05
Epoch 65: Loss = 0.2095, LR = 7.61e-05
Epoch 66: Loss = 0.2101, LR = 7.55e-05
Epoch 67: Loss = 0.2089, LR = 7.48e-05
Epoch 68: Loss = 0.2087, LR = 7.41e-05
Epoch 69: Loss = 0.2096, LR = 7.34e-05
Epoch 70: Loss = 0.2082, LR = 7.27e-05
Epoch 71: Loss = 0.2088, LR = 7.20e-05
Epoch 72: Loss = 0.2086, LR = 7.13e-05
Epoch 73: Loss = 0.2073, LR = 7.06e-05
Epoch 74: Loss = 0.2090, LR = 6.99e-05
Epoch 75: Loss = 0.2087, LR = 6.91e-05
Epoch 76: Loss = 0.2083, LR = 6.84e-05
Epoch 77: Loss = 0.2077, LR = 6.77e-05
Epoch 78: Loss = 0.2074, LR = 6.69e-05
Epoch 79: Loss = 0.2078, LR = 6.62e-05
Epoch 80: Loss = 0.2074, LR = 6.55e-05
Epoch 81: Loss = 0.2076, LR = 6.47e-05
Epoch 82: Loss = 0.2067, LR = 6.39e-05
Epoch 83: Loss = 0.2068, LR = 6.32e-05
Epoch 84: Loss = 0.2086, LR = 6.24e-05
Epoch 85: Loss = 0.2063, LR = 6.17e-05
Epoch 86: Loss = 0.2072, LR = 6.09e-05
Epoch 87: Loss = 0.2073, LR = 6.01e-05
Epoch 88: Loss = 0.2065, LR = 5.94e-05
Epoch 89: Loss = 0.2073, LR = 5.86e-05
Epoch 90: Loss = 0.2066, LR = 5.78e-05
Epoch 91: Loss = 0.2063, LR = 5.70e-05
Epoch 92: Loss = 0.2074, LR = 5.63e-05
Epoch 93: Loss = 0.2067, LR = 5.55e-05
Epoch 94: Loss = 0.2064, LR = 5.47e-05
Epoch 95: Loss = 0.2069, LR = 5.39e-05
Epoch 96: Loss = 0.2060, LR = 5.31e-05
Epoch 97: Loss = 0.2064, LR = 5.24e-05
Epoch 98: Loss = 0.2062, LR = 5.16e-05
Epoch 99: Loss = 0.2062, LR = 5.08e-05
Epoch 100: Loss = 0.2063, LR = 5.00e-05
Epoch 101: Loss = 0.2065, LR = 4.92e-05
Epoch 102: Loss = 0.2055, LR = 4.84e-05
Epoch 103: Loss = 0.2069, LR = 4.76e-05
Epoch 104: Loss = 0.2056, LR = 4.69e-05
Epoch 105: Loss = 0.2055, LR = 4.61e-05
Epoch 106: Loss = 0.2059, LR = 4.53e-05
Epoch 107: Loss = 0.2061, LR = 4.45e-05
Epoch 108: Loss = 0.2049, LR = 4.37e-05
Epoch 109: Loss = 0.2065, LR = 4.30e-05
Epoch 110: Loss = 0.2048, LR = 4.22e-05
Epoch 111: Loss = 0.2051, LR = 4.14e-05
Epoch 112: Loss = 0.2053, LR = 4.06e-05
Epoch 113: Loss = 0.2047, LR = 3.99e-05
Epoch 114: Loss = 0.2053, LR = 3.91e-05
Epoch 115: Loss = 0.2055, LR = 3.83e-05
Epoch 116: Loss = 0.2051, LR = 3.76e-05
Epoch 117: Loss = 0.2052, LR = 3.68e-05
Epoch 118: Loss = 0.2053, LR = 3.61e-05
Epoch 119: Loss = 0.2044, LR = 3.53e-05
Epoch 120: Loss = 0.2046, LR = 3.45e-05
Epoch 121: Loss = 0.2050, LR = 3.38e-05
Epoch 122: Loss = 0.2046, LR = 3.31e-05
Epoch 123: Loss = 0.2048, LR = 3.23e-05
Epoch 124: Loss = 0.2048, LR = 3.16e-05
Epoch 125: Loss = 0.2041, LR = 3.09e-05
Epoch 126: Loss = 0.2049, LR = 3.01e-05
Epoch 127: Loss = 0.2046, LR = 2.94e-05
Epoch 128: Loss = 0.2038, LR = 2.87e-05
Epoch 129: Loss = 0.2047, LR = 2.80e-05
Epoch 130: Loss = 0.2043, LR = 2.73e-05
Epoch 131: Loss = 0.2043, LR = 2.66e-05
Epoch 132: Loss = 0.2038, LR = 2.59e-05
Epoch 133: Loss = 0.2042, LR = 2.52e-05
Epoch 134: Loss = 0.2046, LR = 2.45e-05
Epoch 135: Loss = 0.2034, LR = 2.39e-05
Epoch 136: Loss = 0.2035, LR = 2.32e-05
Epoch 137: Loss = 0.2038, LR = 2.25e-05
Epoch 138: Loss = 0.2051, LR = 2.19e-05
Epoch 139: Loss = 0.2040, LR = 2.12e-05
Epoch 140: Loss = 0.2031, LR = 2.06e-05
Epoch 141: Loss = 0.2033, LR = 2.00e-05
Epoch 142: Loss = 0.2028, LR = 1.94e-05
Epoch 143: Loss = 0.2040, LR = 1.87e-05
Epoch 144: Loss = 0.2032, LR = 1.81e-05
Epoch 145: Loss = 0.2025, LR = 1.75e-05
Epoch 146: Loss = 0.2027, LR = 1.69e-05
Epoch 147: Loss = 0.2035, LR = 1.63e-05
Epoch 148: Loss = 0.2027, LR = 1.58e-05
Epoch 149: Loss = 0.2032, LR = 1.52e-05
Epoch 150: Loss = 0.2022, LR = 1.46e-05
Epoch 151: Loss = 0.2029, LR = 1.41e-05
Epoch 152: Loss = 0.2025, LR = 1.36e-05
Epoch 153: Loss = 0.2027, LR = 1.30e-05
Epoch 154: Loss = 0.2032, LR = 1.25e-05
Epoch 155: Loss = 0.2030, LR = 1.20e-05
Epoch 156: Loss = 0.2022, LR = 1.15e-05
Epoch 157: Loss = 0.2037, LR = 1.10e-05
Epoch 158: Loss = 0.2031, LR = 1.05e-05
Epoch 159: Loss = 0.2027, LR = 1.00e-05
Epoch 160: Loss = 0.2033, LR = 9.55e-06
Epoch 161: Loss = 0.2023, LR = 9.09e-06
Epoch 162: Loss = 0.2029, LR = 8.65e-06
Epoch 163: Loss = 0.2024, LR = 8.21e-06
Epoch 164: Loss = 0.2024, LR = 7.78e-06
Epoch 165: Loss = 0.2033, LR = 7.37e-06
Epoch 166: Loss = 0.2026, LR = 6.96e-06
Epoch 167: Loss = 0.2027, LR = 6.57e-06
Epoch 168: Loss = 0.2026, LR = 6.18e-06
Epoch 169: Loss = 0.2023, LR = 5.81e-06
Epoch 170: Loss = 0.2018, LR = 5.45e-06
Epoch 171: Loss = 0.2023, LR = 5.10e-06
Epoch 172: Loss = 0.2024, LR = 4.76e-06
Epoch 173: Loss = 0.2024, LR = 4.43e-06
Epoch 174: Loss = 0.2018, LR = 4.11e-06
Epoch 175: Loss = 0.2021, LR = 3.81e-06
Epoch 176: Loss = 0.2024, LR = 3.51e-06
Epoch 177: Loss = 0.2023, LR = 3.23e-06
Epoch 178: Loss = 0.2014, LR = 2.96e-06
Epoch 179: Loss = 0.2022, LR = 2.70e-06
Epoch 180: Loss = 0.2030, LR = 2.45e-06
Epoch 181: Loss = 0.2023, LR = 2.21e-06
Epoch 182: Loss = 0.2021, LR = 1.99e-06
Epoch 183: Loss = 0.2018, LR = 1.77e-06
Epoch 184: Loss = 0.2022, LR = 1.57e-06
Epoch 185: Loss = 0.2030, LR = 1.38e-06
Epoch 186: Loss = 0.2022, LR = 1.20e-06
Epoch 187: Loss = 0.2025, LR = 1.04e-06
Epoch 188: Loss = 0.2022, LR = 8.86e-07
Epoch 189: Loss = 0.2019, LR = 7.45e-07
Epoch 190: Loss = 0.2015, LR = 6.16e-07
Epoch 191: Loss = 0.2016, LR = 4.99e-07
Epoch 192: Loss = 0.2022, LR = 3.94e-07
Epoch 193: Loss = 0.2016, LR = 3.02e-07
Epoch 194: Loss = 0.2013, LR = 2.22e-07
Epoch 195: Loss = 0.2031, LR = 1.54e-07
Epoch 196: Loss = 0.2020, LR = 9.87e-08
Epoch 197: Loss = 0.2022, LR = 5.55e-08
Epoch 198: Loss = 0.2024, LR = 2.47e-08
Epoch 199: Loss = 0.2022, LR = 6.17e-09
Epoch 200: Loss = 0.2018, LR = 0.00e+00
Training complete. Best loss: 0.2013

Starting generation...
============================================================
CSDI Trajectory Generator - Generation
============================================================
Loading real data for condition sampling from: /home/vsokolov/projects/svtrip/data/Microtrips
Search pattern: /home/vsokolov/projects/svtrip/data/Microtrips/**/results_trip_*.csv
Found 6367 files
Loaded 1970 real conditions for sampling
Generating 1000 trajectories...
  Diffusion steps: 200
  Smoothing kernel: 7
  Boundary ramp: 3 (conditional)
  Condition stats:
    Avg speed range: 8.5 - 30.7 m/s
    Duration range: 51 - 512 s
    Vehicle dynamics: 0.08 - 0.94 (0=heavy truck, 1=sports car)
  Starting reverse diffusion (200 steps)...
    Step 50/200 complete
    Step 100/200 complete
    Step 150/200 complete
    Step 200/200 complete
  Diffusion complete, applying post-processing...
    Smoothing applied (kernel=7)
    Boundary ramps applied (ramp=3)
Diffusion sampling complete!
Post-processing stats:
  Speed - Mean: 17.98, Std: 7.23, Max: 38.86 m/s
  Accel - Mean: 0.0000, Std: 0.5790 m/s²
Saved samples plot: csdi_samples_20260101_191644.png

Starting evaluation...
============================================================
CSDI Trajectory Evaluation
============================================================
Auto-detected synthetic file: /home/vsokolov/projects/svtrip/paper3/code/csdi/csdi_synthetic_20260101_191644.csv
Loading 6367 real trajectory files...
Loaded 6286 valid real trajectories
Loading from CSV: /home/vsokolov/projects/svtrip/paper3/code/csdi/csdi_synthetic_20260101_191644.csv

Real trajectories: 6286
Synthetic trajectories: 1000

============================================================
Running Evaluation Metrics
============================================================
Running comprehensive evaluation...
  [1/7] SAFD metrics...
  [2/7] VSP metrics...
  [3/7] Jerk metrics...
  [4/7] Distribution metrics...
  [5/7] Boundary metrics...
  [6/7] Discriminative score...
  [7/7] TSTR predictive score...
Evaluation complete!

============================================================
EVALUATION RESULTS
============================================================

Key Metrics:
----------------------------------------
  SAFD Wasserstein: 0.0003
  Speed Wasserstein: 1.1992
  Accel Wasserstein: 0.0305
  MMD: 0.0100
  Discriminative Score: 0.4954
  Boundary Violation Rate: 0.0000
  TSTR MAE: 0.3799

Saved metrics: /home/vsokolov/projects/svtrip/paper3/code/csdi/csdi_metrics_20260101_191652.json
Saved report: /home/vsokolov/projects/svtrip/paper3/code/csdi/csdi_report_20260101_191652.csv
Saved comparison plot: /home/vsokolov/projects/svtrip/paper3/code/csdi/csdi_evaluation_20260101_191652.png

============================================================
SUMMARY COMPARISON
============================================================

Metric                         Real            CSDI           
------------------------------------------------------------
Mean Speed (m/s)               16.96           16.96          
Std Speed (m/s)                5.92            5.91           
Mean Duration (s)              307.3           252.1          
Max Speed (m/s)                39.56           38.86          

✅ Evaluation complete!

==============================================
Completed: Thu Jan  1 19:17:16 EST 2026
==============================================
