Requirement already satisfied: torch in /home/vsokolov/.local/lib/python3.10/site-packages (2.9.1)
Requirement already satisfied: pandas in /home/vsokolov/.local/lib/python3.10/site-packages (2.3.3)
Requirement already satisfied: numpy in /home/vsokolov/.local/lib/python3.10/site-packages (2.2.6)
Requirement already satisfied: matplotlib in /home/vsokolov/.local/lib/python3.10/site-packages (3.10.8)
Requirement already satisfied: scipy in /home/vsokolov/.local/lib/python3.10/site-packages (1.15.3)
Requirement already satisfied: tqdm in /home/vsokolov/.local/lib/python3.10/site-packages (4.67.1)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.8.90)
Requirement already satisfied: typing-extensions>=4.10.0 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (4.15.0)
Requirement already satisfied: nvidia-nvshmem-cu12==3.3.20 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (3.3.20)
Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.8.90)
Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (0.7.1)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (11.7.3.90)
Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (1.13.1.3)
Requirement already satisfied: triton==3.5.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (3.5.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (11.3.3.83)
Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (10.3.9.90)
Requirement already satisfied: jinja2 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (3.1.6)
Requirement already satisfied: fsspec>=0.8.5 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (2025.12.0)
Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (9.10.2.21)
Requirement already satisfied: networkx>=2.5.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (3.4.2)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.8.90)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.5.8.93)
Requirement already satisfied: filelock in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (3.20.1)
Requirement already satisfied: sympy>=1.13.3 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (1.14.0)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.8.93)
Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.8.4.1)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (12.8.93)
Requirement already satisfied: nvidia-nccl-cu12==2.27.5 in /home/vsokolov/.local/lib/python3.10/site-packages (from torch) (2.27.5)
Requirement already satisfied: pytz>=2020.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /home/vsokolov/.local/lib/python3.10/site-packages (from pandas) (2025.3)
Requirement already satisfied: python-dateutil>=2.8.2 in /home/vsokolov/.local/lib/python3.10/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: kiwisolver>=1.3.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (1.4.9)
Requirement already satisfied: contourpy>=1.0.1 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (1.3.2)
Requirement already satisfied: fonttools>=4.22.0 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (4.61.1)
Requirement already satisfied: packaging>=20.0 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (25.0)
Requirement already satisfied: pyparsing>=3 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (3.3.1)
Requirement already satisfied: cycler>=0.10 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: pillow>=8 in /home/vsokolov/.local/lib/python3.10/site-packages (from matplotlib) (12.0.0)
Requirement already satisfied: six>=1.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/miniconda3-22.11.1-gy/lib/python3.10/site-packages (from python-dateutil>=2.8.2->pandas) (1.16.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/vsokolov/.local/lib/python3.10/site-packages (from sympy>=1.13.3->torch) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /home/vsokolov/.local/lib/python3.10/site-packages (from jinja2->torch) (3.0.3)
Starting Training Job: pid mode, 5000 epochs
Data Path: /projects/vsokolov/svtrip/data/Microtrips
Loading dataset from cache: data/dataset_cache.pt
Dataset loaded: 6367 trajectories (Cached).
Starting PID training (Physics-Informed Diffusion)...
DEBUG: Epochs: 5000, Batch Size: 256, Dataset Len: 6367
Epoch 100/5000 | Loss: 0.00846 (MSE base: 0.00813)
Epoch 100/5000 | MSE: 0.00846
Epoch 200/5000 | Loss: 0.00735 (MSE base: 0.00622)
Epoch 200/5000 | MSE: 0.00735
Epoch 300/5000 | Loss: 0.00790 (MSE base: 0.00493)
Epoch 300/5000 | MSE: 0.00790
Epoch 400/5000 | Loss: 0.00715 (MSE base: 0.00720)
Epoch 400/5000 | MSE: 0.00715
Epoch 500/5000 | Loss: 0.00634 (MSE base: 0.00542)
Epoch 500/5000 | MSE: 0.00634
Epoch 600/5000 | Loss: 0.00607 (MSE base: 0.00529)
Epoch 600/5000 | MSE: 0.00607
Epoch 700/5000 | Loss: 0.00637 (MSE base: 0.00668)
Epoch 700/5000 | MSE: 0.00637
Epoch 800/5000 | Loss: 0.00611 (MSE base: 0.00546)
Epoch 800/5000 | MSE: 0.00611
Epoch 900/5000 | Loss: 0.00609 (MSE base: 0.00557)
Epoch 900/5000 | MSE: 0.00609
Epoch 1000/5000 | Loss: 0.00716 (MSE base: 0.00571)
Epoch 1000/5000 | MSE: 0.00716
Epoch 1100/5000 | Loss: 0.00666 (MSE base: 0.00478)
Epoch 1100/5000 | MSE: 0.00666
Epoch 1200/5000 | Loss: 0.00563 (MSE base: 0.00624)
Epoch 1200/5000 | MSE: 0.00563
Epoch 1300/5000 | Loss: 0.00555 (MSE base: 0.00569)
Epoch 1300/5000 | MSE: 0.00555
Epoch 1400/5000 | Loss: 0.00561 (MSE base: 0.00627)
Epoch 1400/5000 | MSE: 0.00561
Epoch 1500/5000 | Loss: 0.00570 (MSE base: 0.00498)
Epoch 1500/5000 | MSE: 0.00570
Epoch 1600/5000 | Loss: 0.00593 (MSE base: 0.00659)
Epoch 1600/5000 | MSE: 0.00593
Epoch 1700/5000 | Loss: 0.00578 (MSE base: 0.00572)
Epoch 1700/5000 | MSE: 0.00578
Epoch 1800/5000 | Loss: 0.00581 (MSE base: 0.00602)
Epoch 1800/5000 | MSE: 0.00581
Epoch 1900/5000 | Loss: 0.00595 (MSE base: 0.00486)
Epoch 1900/5000 | MSE: 0.00595
Epoch 2000/5000 | Loss: 0.00550 (MSE base: 0.00408)
Epoch 2000/5000 | MSE: 0.00550
Epoch 2100/5000 | Loss: 0.00557 (MSE base: 0.00498)
Epoch 2100/5000 | MSE: 0.00557
Epoch 2200/5000 | Loss: 0.00542 (MSE base: 0.00471)
Epoch 2200/5000 | MSE: 0.00542
Epoch 2300/5000 | Loss: 0.00534 (MSE base: 0.00601)
Epoch 2300/5000 | MSE: 0.00534
Epoch 2400/5000 | Loss: 0.00631 (MSE base: 0.00546)
Epoch 2400/5000 | MSE: 0.00631
Epoch 2500/5000 | Loss: 0.00540 (MSE base: 0.00568)
Epoch 2500/5000 | MSE: 0.00540
Epoch 2600/5000 | Loss: 0.00543 (MSE base: 0.00393)
Epoch 2600/5000 | MSE: 0.00543
Epoch 2700/5000 | Loss: 0.00559 (MSE base: 0.00534)
Epoch 2700/5000 | MSE: 0.00559
Epoch 2800/5000 | Loss: 0.00514 (MSE base: 0.00463)
Epoch 2800/5000 | MSE: 0.00514
Epoch 2900/5000 | Loss: 0.00523 (MSE base: 0.00563)
Epoch 2900/5000 | MSE: 0.00523
Epoch 3000/5000 | Loss: 0.00522 (MSE base: 0.00555)
Epoch 3000/5000 | MSE: 0.00522
Epoch 3100/5000 | Loss: 0.00524 (MSE base: 0.00513)
Epoch 3100/5000 | MSE: 0.00524
Epoch 3200/5000 | Loss: 0.00534 (MSE base: 0.00560)
Epoch 3200/5000 | MSE: 0.00534
Epoch 3300/5000 | Loss: 0.00570 (MSE base: 0.00465)
Epoch 3300/5000 | MSE: 0.00570
Epoch 3400/5000 | Loss: 0.00547 (MSE base: 0.00544)
Epoch 3400/5000 | MSE: 0.00547
Epoch 3500/5000 | Loss: 0.00538 (MSE base: 0.00491)
Epoch 3500/5000 | MSE: 0.00538
Epoch 3600/5000 | Loss: 0.00520 (MSE base: 0.00517)
Epoch 3600/5000 | MSE: 0.00520
Epoch 3700/5000 | Loss: 0.00521 (MSE base: 0.00567)
Epoch 3700/5000 | MSE: 0.00521
Epoch 3800/5000 | Loss: 0.00514 (MSE base: 0.00478)
Epoch 3800/5000 | MSE: 0.00514
Epoch 3900/5000 | Loss: 0.00510 (MSE base: 0.00485)
Epoch 3900/5000 | MSE: 0.00510
Epoch 4000/5000 | Loss: 0.00531 (MSE base: 0.00626)
Epoch 4000/5000 | MSE: 0.00531
Epoch 4100/5000 | Loss: 0.00534 (MSE base: 0.00675)
Epoch 4100/5000 | MSE: 0.00534
Epoch 4200/5000 | Loss: 0.00481 (MSE base: 0.00431)
Epoch 4200/5000 | MSE: 0.00481
Epoch 4300/5000 | Loss: 0.00548 (MSE base: 0.00515)
Epoch 4300/5000 | MSE: 0.00548
Epoch 4400/5000 | Loss: 0.00521 (MSE base: 0.00479)
Epoch 4400/5000 | MSE: 0.00521
Epoch 4500/5000 | Loss: 0.00497 (MSE base: 0.00358)
Epoch 4500/5000 | MSE: 0.00497
Epoch 4600/5000 | Loss: 0.00505 (MSE base: 0.00503)
Epoch 4600/5000 | MSE: 0.00505
Epoch 4700/5000 | Loss: 0.00472 (MSE base: 0.00424)
Epoch 4700/5000 | MSE: 0.00472
Epoch 4800/5000 | Loss: 0.00501 (MSE base: 0.00367)
Epoch 4800/5000 | MSE: 0.00501
Epoch 4900/5000 | Loss: 0.00501 (MSE base: 0.00416)
Epoch 4900/5000 | MSE: 0.00501
Epoch 5000/5000 | Loss: 0.00492 (MSE base: 0.00643)
Epoch 5000/5000 | MSE: 0.00492
Training Complete.
Training complete. Generating baseline samples...
Generating trajectories...
Loading real data stats from data/real_data_stats.pkl for Condition Sampling...
Reconstructing metadata from raw speeds...
Sampling conditions from 500 real trips.
Applying Tail Stretching...
Applying Global Distance Constraint...
Saved data/synthetic_trajectories_jan03_0552pm.csv
Saved report/validation_plot_jan03_0552pm.png
Generating 5x10 grid plot...
Saved grid plot: report/validation_grid_jan03_0552pm.png
Warning: Could not import shared evaluation_metrics. Some metrics will be unavailable.
--- Starting Evaluation ---
Calculating metrics...
----------------------------------------
Metric                    Value     
----------------------------------------
Wasserstein Speed:       4.4044
Wasserstein Accel:       0.2545
Wasserstein VSP:         9.6036
Wasserstein SAFD (2D):   0.0013
MMD:                     0.0000
Discriminative Score:    0.0000
TSTR MAE:                0.0000
LDLJ (Smoothness) Real:  -11.0779
LDLJ (Smoothness) Syn:   -11.9970
Boundary Violation Rate: 100.00%
KS Stat VSP:             0.1738 (p=0.0000)
----------------------------------------

Summary Comparison:
Stat                 Real       Syn       
Mean Speed (m/s)     17.00      17.01     
Max Speed (m/s)      38.83      60.97     
Mean Duration (s)    317.4      237.8     
----------------------------------------
Saved report/evaluation_plots_pid_final_jan03_0552pm.png
Saved report/evaluation_report_pid_final_jan03_0552pm.md
Job Complete
